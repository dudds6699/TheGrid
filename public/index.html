<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>This is it</title>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <script src="scripts/pixi.js"></script>
        <script src="scripts/keyboard.js"></script>
        <script src="scripts/PlayerObj.js"></script>
    </head>
    <body>
        <script>
            
            var resx = 800;
            var resy = 600;
        
            // create an new instance of a pixi stage
            var container = new PIXI.Container();
            var loader = PIXI.loader;
             
            // create a renderer instance.
            var renderer = PIXI.autoDetectRenderer(resx, resy);
             
            // add the renderer view element to the DOM
            document.body.appendChild(renderer.view);
             
             
            loader
                .add("pics/bunny.png")
                .load(setup);
             
            var player1;
            var state;
            var texture;
            var continueAn = true;
            function setup(){
                player1 = null;
                //Capture the keyboard arrow keys
                var left = keyboard(37),
                    up = keyboard(38),
                    right = keyboard(39),
                    down = keyboard(40);
                    
                requestAnimationFrame( animate );
                
                // create a texture from an image path
                texture = PIXI.Texture.fromImage("pics/bunny.png");
                // create a new Sprite using the texture
                player1 = new player(texture,resx / 2,resy / 2);
                player1.setContainer(container);
                
                //basic game logic
                left.press = function(){
                    player1.left();
                }
                
                up.press = function() {
                    player1.up();
                }
                
                right.press = function(){
                    player1.right();                  
                }
                
                down.press = function() {
                    player1.down();
                }
                
                //Set the game state
                state = play;
                
                animate();
            }
            
            function animate() {
                var check = true;
             
             if(continueAn){
                requestAnimationFrame( animate );
                //bunny.rotation += 0.1;
                // render the stage   
                state();
                
                renderer.render(container);
             }
             
            }
                
            function play(){
                //Use the cat's velocity to make it move
                player1.update(container);
                var check = player1.crash(container, resx, resy)
                if(check){
                    reset();
                }
                
            }
            
            function reset(){
                continueAn = false;
                container.removeChildren();
                console.log("called");
            }
        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    </body>
</html>