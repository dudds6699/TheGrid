<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>This is it</title>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <script src="scripts/pixi.js"></script>
        <script src="scripts/keyboard.js"></script>
        <script src="scripts/PlayerObj.js"></script>
    </head>
    <body>
        <script>
            
            var resx = 800;
            var resy = 600;
        
            // create an new instance of a pixi stage
            var container = new PIXI.Container();
            var loader = PIXI.loader;
             
            // create a renderer instance.
            var renderer = PIXI.autoDetectRenderer(resx, resy);
             
            // add the renderer view element to the DOM
            document.body.appendChild(renderer.view);
             
             
            loader
                .add("pics/player1.png")
                .add("pics/player2.png")
                .load(setup);
             
            var player1;
            var state;
            var texture;
            var continueAn = true;
            
            //Capture the keyboard arrow keys
            var left = keyboard(37),
                up = keyboard(38),
                right = keyboard(39),
                down = keyboard(40);
                start = keyboard(32);
                enter = keyboard(13);

                //basic game logic
                left.press = function(){
                    player1.left();
                }
                
                up.press = function() {
                    player1.up();
                }
                
                right.press = function(){
                    player1.right();                  
                }
                
                down.press = function() {
                    player1.down();
                }            
                
                start.press = function(){
                    container.removeChildren();
                // create a new Sprite using the texture
                    player1 = new player(texture,resx / 2,resy / 2, "Player 1");
                    player1.start(container);
                    state = play;
                }
                
                enter.press = function() {
                    //for debuging
                    for(var i = 0; i<container.children.length; i++){
                        console.log("x:" + container.children[i].x + ", y:"+ container.children[i].y);
                        console.log("height:" + container.children[i].height + " ,width:" +container.children[i].width)
                        console.log("px:" + player1.futurexy.x + " ,y:" + player1.futurexy.y);
                    }
                }
            
            function nonplay(){
                //this is to avoid js errors in the console.
                return true;
            }
            
            
            function setup(){
                    
                requestAnimationFrame( animate );
                
                // create a texture from an image path
                texture = PIXI.Texture.fromImage("pics/player1.png");
                
                //Set the game state right now its no state
                state = nonplay;
                
                animate();
            }
            
            function animate() {
                requestAnimationFrame( animate );
                state();
                renderer.render(container);
            }
                
            function play(){
                player1.update(container);
                //checks if the player crashes
                player1.hasCrashed(container, resx, resy);
            }

        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    </body>
</html>